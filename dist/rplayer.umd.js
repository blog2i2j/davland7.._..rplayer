(function(t,i){typeof exports=="object"&&typeof module<"u"?module.exports=i(require("hls.js")):typeof define=="function"&&define.amd?define(["hls.js"],i):(t=typeof globalThis<"u"?globalThis:t||self,t.rPlayer=i(t.Hls))})(this,function(t){"use strict";class i extends Audio{constructor(){super(),this.key="rplayer-volume",this.volume=this.isIOS()?1:parseFloat(localStorage.getItem(this.key)||"0.2")}async playSrc(e){const h=e.indexOf(".m3u8")>0;if(this.isPaused(e))this.play();else{this.stop(),this.src=e,typeof t<"u"&&t.isSupported()&&h&&!this.isIOS()?(this.hls=new t,this instanceof HTMLAudioElement&&this.hls.attachMedia(this),this.hls.loadSource(e),await new Promise(s=>{var o;(o=this.hls)==null||o.on(t.Events.MANIFEST_PARSED,()=>{s()})})):(this.src=e,await new Promise(s=>{this.addEventListener("loadedmetadata",()=>{s()})}));try{await this.play()}catch(s){console.error("Error on play",s)}}}mute(){this.muted=!this.muted}stop(){this.pause(),this.currentTime=0,this.hls&&(this.hls.destroy(),this.hls=null)}rewind(e){this.currentTime-=e}upVolume(){this.volume<1&&(this.volume=parseFloat((this.volume+.1).toFixed(1)),localStorage.setItem(this.key,this.volume.toString()))}downVolume(){!this.isIOS()&&this.volume>.1?(this.volume=parseFloat((this.volume-.1).toFixed(1)),localStorage.setItem(this.key,this.volume.toString())):this.isIOS()||(this.volume=0,localStorage.setItem(this.key,"0"))}get isHls(){return t instanceof Object&&this.hls!==null&&this.hls instanceof t}get url(){return this.isHls?this.hls.url:this.src}get playing(){return this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2}isIOS(){return typeof navigator<"u"&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1)}isPaused(e){return this.currentTime>0&&!this.playing&&this.url===e}}return i});

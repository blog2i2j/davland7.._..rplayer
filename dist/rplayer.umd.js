(function(t,s){typeof exports=="object"&&typeof module<"u"?module.exports=s(require("hls.js")):typeof define=="function"&&define.amd?define(["hls.js"],s):(t=typeof globalThis<"u"?globalThis:t||self,t.rPlayer=s(t.Hls))})(this,function(t){"use strict";class s extends Audio{constructor(){super();const e="rplayer-volume";this.hls=null,localStorage.hasOwnProperty(e)?this.volume=parseFloat(localStorage.getItem(e)):this.volume=.2,this.onvolumechange=()=>{localStorage.setItem(e,this.volume.toString())}}async playSrc(e){const h=e.indexOf(".m3u8")>0;if(this.isPaused(e))this.play();else{this.stop(),t.isSupported()&&h?(this.hls=new t,this instanceof HTMLAudioElement&&this.hls.attachMedia(this),this.hls.loadSource(e),await new Promise(i=>{var l;(l=this.hls)==null||l.on(t.Events.MANIFEST_PARSED,()=>{i()})})):!this.hls&&(this.canPlayType("application/vnd.apple.mpegurl")||!h&&t.isSupported())&&(this.src=e,await new Promise(i=>{this.addEventListener("loadedmetadata",()=>{i()})}));try{await this.play()}catch(i){console.error("Error on play",i)}}}mute(){this.muted=!this.muted}stop(){this.pause(),this.currentTime=0,this.hls&&(this.hls.destroy(),this.hls=null)}upVolume(){this.setVolume(this.volume+.1)}downVolume(){this.setVolume(this.volume-.1)}setVolume(e){e>=0&&e<=1&&(this.volume=parseFloat(e.toFixed(1)))}isPaused(e){return this.currentTime>0&&!this.playing&&this.url===e}get isHls(){return this.hls instanceof t}get url(){var e;return this.isHls?(e=this.hls)==null?void 0:e.url:this.src}get playing(){return this.currentTime>0&&!this.paused&&!this.ended&&this.readyState>2}}return s});
